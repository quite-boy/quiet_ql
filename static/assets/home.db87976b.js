import{r as a,C as e,a as l,o as t,c as s,d as n,w as i,F as o,x as r,D as u,M as d,e as c,u as m,E as v,U as g,G as f,I as p,j as y,J as _,N as k,O as R,P as S,R as b,l as w,T as I,V as x,W as A,X as h,Y as C,Z as Y,h as j,_ as O}from"./vendor.04a5b875.js";import{d as U}from"./dayjs.min.5ae10159.js";/* empty css              */import"./stringify.a14b55a2.js";import{g as E,e as N,a as J,b as M,c as D,d as H}from"./index.4da51d6c.js";const L=["innerHTML"],T={key:0,class:"login_info"},z=y(" 当前用户尚未登录,请点击下方登录 "),F={class:"login_info"},G=y("获取登录二维码"),P=y("唤醒App添加"),$={class:"login_info"},q=["src"],Q={key:1},V={class:"choose"},W=y(" 请选择账号 "),X={class:"userDetail"},Z={style:{"margin-right":"20px"}},B=y("修改备注"),K=y("删除账号"),aa={setup(aa){a("");const ea=e("reload");let la=a(localStorage.getItem("USERARRAY")?JSON.parse(localStorage.getItem("USERARRAY")):[]);const ta=a(!1),sa=a(!1),na=a(null),ia=a(null);let oa=a(0),ra=l({}),ua=a(""),da=a({});const ca=a(!1),ma=a(!0);let va=a(null),ga=a(""),fa=a(JSON.parse(sessionStorage.getItem("INFO")));const pa=async()=>{ta.value=!0;const a=await J();200==a.status&&(na.value=a.data.data.QRCode,ra=a.data.data,ta.value=!1,clearInterval(ia.value),ia.value=setInterval((()=>{ya()}),2500))},ya=async()=>{const a=await M(ra);if(200==a.status){if(0==a.data.data.errcode){clearInterval(ia.value);let e={eid:a.data.data.eid,name:a.data.data.nickName},l=localStorage.getItem("USERARRAY")?JSON.parse(localStorage.getItem("USERARRAY")):[],t=!1;return l.forEach((a=>{a.name==e.name&&(a.eid=e.eid,t=!0)})),t||l.push(e),localStorage.setItem("USERARRAY",JSON.stringify(l)),r.success(a.data.message),void ea()}if(176==a.data.data.errcode)return;return r.error(a.data.message),void clearInterval(ia.value)}},_a=async(a,e)=>{ua.value=a.key,ga.value=la.value.filter((e=>e.eid==a.key))[0].name;const{data:l}=await D({eid:a.key});l&&l.code?r.error(l.message):(da.value=l.data.env,da.value.timestamp=U(da.value.timestamp).format("YYYY-MM-DD HH:mm:ss"),ma.value=!1,va.value=da.value.remarks,sessionStorage.setItem("Cookie",da.value.value))},ka=async()=>{const{data:a}=await N({eid:ua.value,remark:va.value});r.info(a.message),ca.value=!1},Ra=async()=>{sa.value=!0;const a=await J();ra=a.data.data;const e=`openapp.jdmobile://virtual/ad?params={"category":"jump","des":"ThirdPartyLogin","action":"to","onekeylogin":"return","url":"https://plogin.m.jd.com/cgi-bin/m/tmauth?appid=300&client_type=m&token=${a.data.data.token}","authlogin_returnurl":"weixin://","browserlogin_fromurl":"${window.location.host}"}`;window.location.href=e,sa.value=!1,clearInterval(ia.value),ia.value=setInterval((()=>{ya()}),2500)},Sa=async()=>{const a=await H({eid:da.value._id});r.info(a.data.message),la.value.find(((a,e)=>{a.eid==da.value._id&&la.value.splice(e,1)})),localStorage.setItem("USERARRAY",JSON.stringify(la.value)),ea()};return(async()=>{const a=await E();oa.value=a.data.data})(),(a,e)=>{const l=R,r=S,U=b,E=O,N=w,J=I,M=x,D=A,H=h,aa=u,ea=C,ia=Y,ra=d;return t(),s(o,null,[n(aa,null,{default:i((()=>[n(l,{type:"warning"},{message:i((()=>[c("div",{innerHTML:m(fa).quiet.LOG},null,8,L)])),_:1}),0==m(la).length?(t(),s("div",T,[z,c("div",F,[n(U,{count:m(oa).marginCount,"overflow-count":99},{default:i((()=>[n(r,{type:"primary",danger:"",loading:ta.value,onClick:pa},{default:i((()=>[G])),_:1},8,["loading"])])),_:1},8,["count"]),n(r,{type:"primary",loading:sa.value,onClick:Ra,style:{"margin-left":"20px"}},{default:i((()=>[P])),_:1},8,["loading"])]),c("div",$,[c("img",{src:na.value,alt:""},null,8,q)])])):(t(),s("div",Q,[c("div",V,[n(J,null,{overlay:i((()=>[n(N,{onClick:_a},{default:i((()=>[(t(!0),s(o,null,v(m(la),(a=>(t(),j(E,{key:a.eid},{default:i((()=>[n(m(g)),y(" "+_(a.name),1)])),_:2},1024)))),128))])),_:1})])),icon:i((()=>[n(m(g))])),default:i((()=>[W])),_:1})]),f(c("div",X,[n(H,{title:"账号详情",bordered:"",column:{xxl:4,xl:3,lg:3,md:3,sm:2,xs:1}},{default:i((()=>[n(M,{label:"用户名"},{default:i((()=>[y(_(m(ga)),1)])),_:1}),n(M,{label:"用户id"},{default:i((()=>[y(_(m(da)._id),1)])),_:1}),n(M,{label:"cookie"},{default:i((()=>[y(_(m(da).value),1)])),_:1}),n(M,{label:"是否禁用"},{default:i((()=>[y(_(m(da).status?"禁用":"未禁用"),1)])),_:1}),n(M,{label:"是否到期"},{default:i((()=>[y(_(m(da).userStatus),1)])),_:1}),n(M,{label:"更新时间"},{default:i((()=>[y(_(m(da).timestamp),1)])),_:1}),n(M,{label:"备注"},{default:i((()=>[c("span",Z,_(m(da).remarks?m(da).remarks:"无备注"),1),n(r,{type:"primary",size:"small",onClick:e[0]||(e[0]=a=>ca.value=!0)},{default:i((()=>[B])),_:1}),n(D,{title:"确认删除此账号吗","ok-text":"是的","cancel-text":"劳资点错了",onConfirm:Sa,onCancel:a.cancel},{default:i((()=>[n(r,{type:"primary",size:"small",danger:"",style:{"margin-left":"20px"}},{default:i((()=>[K])),_:1})])),_:1},8,["onCancel"])])),_:1})])),_:1})],512),[[p,!ma.value]])]))])),_:1}),n(ra,{visible:ca.value,"onUpdate:visible":e[2]||(e[2]=a=>ca.value=a),title:"修改备注",onOk:ka},{default:i((()=>[n(ia,{label:"修改备注"},{default:i((()=>[n(ea,{value:m(va),"onUpdate:value":e[1]||(e[1]=a=>k(va)?va.value=a:va=a)},null,8,["value"])])),_:1})])),_:1},8,["visible"])],64)}}};export{aa as default};
