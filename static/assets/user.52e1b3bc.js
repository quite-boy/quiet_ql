import{r as e,a3 as a,a4 as t,o as l,c as s,d as n,w as i,D as o,u as r,e as d,j as u,J as c,a6 as g,N as m,x as y,P as v,a7 as p,W as f,a5 as x,Y as k,Z as _,a2 as I}from"./vendor.ba7f81bc.js";/* empty css              *//* empty css              */import"./dayjs.min.257340ba.js";/* empty css              *//* empty css              */import{l as h,k as C,d as b,m as j}from"./index.8146c148.js";const w={key:0},S={style:{"text-align":"right","margin-bottom":"20px"}},E=u("检测失效"),z=u("一键删除"),D={key:1},R=u("登录"),J={setup(J){let N=e([]),P=e(!1),T=e(!1),U=e(!1);e(1);let W=e(null),Y=e(!!sessionStorage.getItem("flag")&&sessionStorage.getItem("flag")),Z=e([]);const q=[{title:"变量名",dataIndex:"name",align:"center",ellipsis:!0},{title:"cookie",dataIndex:"value",ellipsis:!0,align:"center"},{title:"备注",dataIndex:"remarks",align:"center",ellipsis:!0},{title:"ID",dataIndex:"_id",align:"center"},{title:"状态",dataIndex:"maturity",align:"center",ellipsis:!0,slots:{customRender:"maturity"}},{title:"操作",dataIndex:"delete",align:"center",slots:{customRender:"delete"}}],A=async()=>{T.value=!0;const{data:e}=await j({key:sessionStorage.getItem("key")});N.value=e.data,T.value=!1},B=a((()=>({total:N.value.length,current:1,pageSize:20}))),F=async()=>{if(200==(await h({key:W.value})).data.data.code)return Y.value=!0,y.success("登录成功"),sessionStorage.setItem("flag",!0),sessionStorage.setItem("key",W.value),void A();y.error("登录失败")},G=async()=>{P.value=!0,T.value=!0;const{data:e}=await C({key:sessionStorage.getItem("key")});Z.value=e.data,0!=Z.value.length?Z.value.forEach((e=>{N.value.forEach((a=>{a._id!=e?a.maturity="正常":a.maturity="到期"}))})):N.value.forEach((e=>{e.maturity="正常"})),P.value=!1,T.value=!1,y.success("检测完毕")},H=()=>{U.value=!0,T.value=!0,Z.value.forEach((async(e,a)=>{await b({eid:e})})),N.value=N.value.filter((e=>"正常"==e.maturity)),U.value=!1,T.value=!1,y.success("删除完毕")};return t((()=>{Y&&A()})),(e,a)=>{const t=v,y=p,h=f,C=x,b=k,j=_,J=I,Z=o;return l(),s("div",null,[n(Z,null,{default:i((()=>[r(Y)?(l(),s("div",w,[d("div",S,[n(t,{type:"primary",style:{"margin-right":"30px"},loading:r(P),onClick:G},{default:i((()=>[E])),_:1},8,["loading"]),n(t,{type:"primary",danger:"",loading:r(U),onClick:H},{default:i((()=>[z])),_:1},8,["loading"])]),n(C,{columns:q,"row-key":e=>e._id,"data-source":r(N),pagination:r(B),loading:r(T),bordered:"",size:"middle",align:"center",onChange:e.handleTableChange},{maturity:i((({text:e})=>[n(y,{color:"到期"==e?"#f50":"#87d068"},{default:i((()=>[u(c(e),1)])),_:2},1032,["color"])])),delete:i((({record:a})=>[n(h,{title:"确认删除此账号吗","ok-text":"是的","cancel-text":"劳资点错了",onConfirm:e=>(async e=>{})(a._id),onCancel:e.cancel},{default:i((()=>[n(r(g),{style:{cursor:"pointer"}})])),_:2},1032,["onConfirm","onCancel"])])),_:1},8,["row-key","data-source","pagination","loading","onChange"])])):(l(),s("div",D,[n(Z,null,{default:i((()=>[n(J,{"wrapper-col":{span:10},"label-col":{span:3}},{default:i((()=>[n(j,{label:"登录key",style:{"text-align":"center"}},{default:i((()=>[n(b,{value:r(W),"onUpdate:value":a[0]||(a[0]=e=>m(W)?W.value=e:W=e)},null,8,["value"]),n(t,{type:"primary",style:{"margin-top":"30px"},onClick:F},{default:i((()=>[R])),_:1})])),_:1})])),_:1})])),_:1})]))])),_:1})])}}};export{J as default};
